<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <link rel="shortcut icon" href="favicon.ico" type="img/x-icon">
        <title>Paris Agreement</title>

        <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic,900" rel="stylesheet" type="text/css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.5/ScrollMagic.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.5/plugins/debug.addIndicators.min.js"></script>

        <link rel="stylesheet" type="text/css" href="css/styles.css">
    </head>
    <body>

        <div class='container'>
            <section id="intro" class="slide">
                <h1>The Paris Agreement</h1>
                <h3>A diplomatic achievement - but will it save the world?</h3>
                <p>On December 12, 2015, 196 countries at the 21st Conference of the Parties negotiated what eventually became the Paris Agreement, a landmark agreement to combat climate change and to accelerate and intensify the actions and investments needed for a sustainable low carbon future.</p>
            </section>
            <section id="signedCountries" class='graphic'>
                <div class='graphic__prose'>
                    <p class='trigger' data-step='0'>The agreement opened for signature on April 22, 2016. Within six months, 17 countries ratified the agreement.</p>
                    <p class='trigger' data-step='1'>By October 5, 2016, over 55 countries in total accounting for 55% of total greenhouse gas emissions ratified the agreement as well, enough for the Paris Agreement to enter into force. <br> <br>
                    Within a year after being open for signature, a total of 117 countries ratified the agreement.</p>
                    <p class='trigger' data-step='2'>Two years later, an additional 53 countries joined.</p>
                    <p class='trigger' data-step='3'>As of September 22, 2018, a total of 180 out of 197 countries have ratified the Paris Agreement.  These countries account for over 90% of total global greenhouse gas emissions.</p>
                </div>
                <div class='graphic__vis'>
                    <div id="bubbleChart" class="chart"></div>
                </div>
            </section>
            <section class="slide">
                <p>Nearly all of the nations of the world have ratified the agreement. Another 17 have signed but not yet ratified.</p>
                <img src="img/ParisAgreementWorldMap.svg">
            </section>
            <section class="slide">
                <p>However, the Paris Agreement is notable not only for the number of countries that have joined but the speed at which they did.</p>
                <p>In contrast, the Kyoto Protocol, another climate-related international agreement, took 5 years for 192 countries to join while the Doha Amendment took 6 years for 115 countries to sign on.
                <div id="signedLineChart" class="chart"></div>
            </section>
            <section class="slide">
                <p id="willHelpText">But will the Paris Agreement help mitigate the impacts of climate change?</p>
            </section>
            <section class="slide">
                <p>While total greenhouse gas emission has been increasing, emissions per person has remained relatively constant over the past 25 years. Indeed, many countries have been exhibiting a slight downward trend prior to the Paris Agreement being created.</p>
                <h2 class="chartTitle">Greenhouse Gas Emissions per Capita, 1990 - 2014</h2>
                <p id="historicalEmissionsName" class="tooltip"></p>
                <div id="historicalEmissionsChart" class="chart"></div>
            </section>
            <section class="slide">
                <p>While there is no way to see what the future holds, various models have been built to forecast how greenhouse gas emissions may change over the next century.</p>
                <p>See what emissions may look like under different scenarios for select regions in the world.</p>
                <div class="dropdownMenu">
                    <label for="regionSelector">Select region: </label>
                    <select id="regionSelector" autocomplete="off">
                        <option value="allSchools" selected>All school types</option>
                        <option value="Africa_Eastern">Africa Eastern</option>
                        <option value="Africa_Northern">Africa Northern</option>
                        <option value="Africa_Southern">Africa Southern</option>
                        <option value="Africa_Western">Africa Western</option>
                        <option value="Argentina">Argentina</option>
                        <option value="Australia/New Zealand">Australia/New Zealand</option>
                        <option value="Brazil">Brazil</option>
                        <option value="Canada">Canada</option>
                        <option value="Central America and Caribbean">Central America and Caribbean</option>
                        <option value="Central Asia">Central Asia</option>
                        <option value="China">China</option>
                        <option value="Colombia">Colombia</option>
                        <option value="EU-12">EU-12</option>
                        <option value="EU-15">EU-15</option>
                        <option value="European Free Trade Association">European Free Trade Association</option>
                        <option value="Europe_Eastern">Eastern Europe</option>
                        <option value="Europe_Non_EU">Non-EU Europe</option>
                        <option value="India">India</option>
                        <option value="Indonesia">Indonesia</option>
                        <option value="Japan">Japan</option>
                        <option value="Mexico">Mexico</option>
                        <option value="Middle East">Middle East</option>
                        <option value="Pakistan">Pakistan</option>
                        <option value="Russia">Russia</option>
                        <option value="South Africa">South Africa</option>
                        <option value="South America_Northern">South America (Northern)</option>
                        <option value="South America_Southern">South America (Southern)</option>
                        <option value="South Asia">South Asia</option>
                        <option value="Southeast Asia">Southeast Asia</option>
                        <option value="South Korea">South Korea</option>
                        <option value="Taiwan">Taiwan</option>
                        <option value="United States">United States</option>
                        <option value="World" selected>World</option>
                    </select>
                </div>
                <div id="chartLegend" class="legend">
                    <div class="legendRow">
                        <span class="legendSquare" style="border: 5px solid #d2d2d2;"></span>
                        <div class="legendText">No policy</div>
                    </div>
                    <div class="legendRow">
                        <span class="legendSquare" style="border: 5px solid #696969;"></span>
                        <div class="legendText">Low policy</div>
                    </div>
                    <div class="legendRow">
                        <span class="legendSquare" style="border: 5px solid #78c26d;"></span>
                        <div class="legendText">Paris - Continued ambition</div>
                    </div>
                    <div class="legendRow">
                        <span class="legendSquare" style="border: 5px solid #55b748;"></span>
                        <div class="legendText">Paris - Increased ambition</div>
                    </div>
                </div>
                <div id="forecastChart" class="chart"></div>
            </section>
        </div>

        <script src="https://d3js.org/d3.v4.min.js"></script>
        <script src="js/bubbleChart.js"></script>
        <script src="js/signedLineChart.js"></script>
        <script src="js/historicalEmissionsChart.js"></script>
        <script src="js/forecastChart.js"></script>
        <script>
            (function() {

                // helper function so we can map over dom selection
                function selectionToArray(selection) {
                    var len = selection.length
                    var result = []
                    for (var i = 0; i < len; i++) {
                        result.push(selection[i])
                    }
                    return result
                }

                    function scrollmagic() {
                        // select elements
                        var graphicEl = document.querySelector('.graphic')
                        var graphicVisEl = graphicEl.querySelector('.graphic__vis')
                        var triggerEls = selectionToArray(graphicEl.querySelectorAll('.trigger'))

                        // viewport height
                        var viewportHeight = window.innerHeight
                        var halfViewportHeight = Math.floor(viewportHeight / 2)

                        // a global function creates and handles all the vis + updates
                        // var graphic = createGraphic('.graphic')
                        var graphic = document.querySelector('#bubbleChart')

                        // handle the fixed/static position of grahpic
                        var toggle = function(fixed, bottom) {
                            if (fixed) graphicVisEl.classList.add('is-fixed')
                            else graphicVisEl.classList.remove('is-fixed')

                            if (bottom) graphicVisEl.classList.add('is-bottom')
                            else graphicVisEl.classList.remove('is-bottom')
                        }

                        // init controller
                        var controller = new ScrollMagic.Controller()

                        // setup a scrollmagic trigger ("scene") for each trigger element
                        var scenes = triggerEls.map(function(el) {
                            // get the step, cast as number
                            var step = +el.getAttribute('data-step')

                            var scene = new ScrollMagic.Scene({
                                triggerElement: el, // our trigger element
                                triggerHook: 'onCenter', // 0.5, defaults to this
                                // duration: el.offsetHeight, // how long it lasts for (in pixels)
                            })

                            scene
                                .on('enter', function(event) {
                                    // tell our graphic to update with a specific step
                                    updateGraph(step)
                                })
                                .on('leave', function(event) {
                                    var nextStep = Math.max(0, step - 1)
                                    updateGraph(nextStep)
                                })

                            // add it to controller so it actually fires
                            scene.addTo(controller)
                        })

                        // create a scene to toggle fixed position
                        var enterExitScene = new ScrollMagic.Scene({
                            triggerElement: graphicEl,
                            triggerHook: '0',
                            duration: graphicEl.offsetHeight - viewportHeight,
                        })

                        enterExitScene
                            .on('enter', function(event) {
                                var fixed = true
                                var bottom = false
                                toggle(fixed, bottom)
                            })
                            .on('leave', function(event) {
                                var fixed = false
                                var bottom = event.scrollDirection === 'FORWARD'
                                toggle(fixed, bottom)
                            })

                        enterExitScene.addTo(controller)
                    }

                    scrollmagic()

            })()
        </script>
    </body>
</html>